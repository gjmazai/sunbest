import React, { FC, useEffect, useRef, useState } from "react";
import MainLogo2 from "./../assets/img/sanbest_logo2.svg";
import { useTypedSelector } from "../hooks/useTypedSelector";
import { summCost } from "../utils/summCost";
import { costDenominator } from "../utils/costDenominator";
import { redirect, useNavigate } from "react-router-dom";
import { RoutesNames } from "../router/router";
import { countLikesProducts } from "../utils/countLikesProducts";

const HeaderMain: FC = () => {
	const { products } = useTypedSelector((state) => state.cart);
	const { promotionProducts } = useTypedSelector((state) => state.promotionProducts);
	const [cost, setCost] = useState(0);
	const [cartCount, setCartCount] = useState(0);
	const [isVivble, setIsVisible] = useState(false);
	const navigate = useNavigate();

	function onClickHandler() {
		navigate(RoutesNames.CART);
	}

	useEffect(() => {
		let newCost = summCost(products);
		setCartCount(products.length);
		setCost(newCost);
	}, [products]);

	return (
		<div className="HeaderMain">
			<img
				src={MainLogo2}
				alt="logo2"
				className="HeaderMain-logo2"
			/>
			<div className="HeaderMain-callback">
				<p className="HeaderMain-callback__number">+7 (XXX) XXX XX XX</p>
				<div className="HeaderMain-callback__text">
					<p className="HeaderMain-callback__text__decor">Обратный звонок</p>
					<p className="HeaderMain-callback__text">Ежедневно с 9 до 22</p>
				</div>
			</div>
			<div className="HeaderMain-icons">
				<div className="HeaderMain-icons__container">
					<svg
						width="25"
						height="19"
						viewBox="0 0 21 20"
						fill="none"
						xmlns="http://www.w3.org/2000/svg"
						className="HeaderMain-icons__icon"
					>
						<path d="M18.5028 2.11164C17.9553 1.44923 17.2677 0.916497 16.4896 0.551809C15.7114 0.187121 14.8621 -0.000440036 14.0028 0.00263663C12.5324 -0.0418843 11.1009 0.478827 10.0028 1.45764C8.90463 0.478827 7.47312 -0.0418843 6.00275 0.00263663C5.1434 -0.000440036 4.29406 0.187121 3.51592 0.551809C2.73778 0.916497 2.05022 1.44923 1.50275 2.11164C0.549754 3.26764 -0.447246 5.36064 0.213754 8.77164C1.26875 14.2186 9.17975 18.6886 9.51375 18.8716C9.66264 18.9547 9.83028 18.9982 10.0008 18.9982C10.1712 18.9982 10.3389 18.9547 10.4878 18.8716C10.8238 18.6846 18.7348 14.2146 19.7878 8.77164C20.4528 5.36064 19.4558 3.26764 18.5028 2.11164ZM17.8288 8.39164C17.0828 12.2426 11.6608 15.8246 10.0028 16.8426C7.66675 15.4326 2.86075 11.8926 2.18175 8.39164C1.66875 5.74564 2.37075 4.20864 3.05075 3.38464C3.41036 2.95075 3.86153 2.60182 4.37191 2.36288C4.88229 2.12395 5.43922 2.00092 6.00275 2.00264C6.60465 1.9575 7.20796 2.06909 7.75389 2.32654C8.29981 2.58399 8.7697 2.97851 9.11775 3.47164C9.20358 3.62957 9.3302 3.7616 9.4844 3.85395C9.63861 3.94631 9.81476 3.99562 9.99451 3.99675C10.1743 3.99787 10.351 3.95076 10.5064 3.86034C10.6617 3.76992 10.79 3.63949 10.8778 3.48264C11.2251 2.98567 11.696 2.58781 12.244 2.32829C12.792 2.06876 13.3982 1.95652 14.0028 2.00264C14.5675 1.99989 15.1258 2.12241 15.6374 2.36139C16.1491 2.60036 16.6014 2.94983 16.9618 3.38464C17.6398 4.20864 18.3418 5.74564 17.8288 8.39164Z" />
					</svg>
					<div className="HeaderMain-icons__count">{countLikesProducts(promotionProducts)}</div>
				</div>

				<div className="HeaderMain-icons__container">
					<svg
						width="25"
						height="19"
						viewBox="0 0 16 19"
						fill="none"
						xmlns="http://www.w3.org/2000/svg"
						className="HeaderMain-icons__icon"
					>
						<path d="M1.25893 8.79492C1.55967 8.79492 1.84808 8.91439 2.06074 9.12704C2.27339 9.33969 2.39286 9.62811 2.39286 9.92885V17.8664C2.39286 18.1671 2.27339 18.4555 2.06074 18.6682C1.84808 18.8808 1.55967 19.0003 1.25893 19.0003C0.958192 19.0003 0.669773 18.8808 0.45712 18.6682C0.244467 18.4555 0.125 18.1671 0.125 17.8664V9.92885C0.125 9.62811 0.244467 9.33969 0.45712 9.12704C0.669773 8.91439 0.958192 8.79492 1.25893 8.79492ZM6.92857 1.99135V17.8664C6.92857 18.1671 7.04804 18.4555 7.26069 18.6682C7.47334 18.8808 7.76176 19.0003 8.0625 19.0003C8.36324 19.0003 8.65166 18.8808 8.86431 18.6682C9.07696 18.4555 9.19643 18.1671 9.19643 17.8664V1.99135C9.19643 1.69061 9.07696 1.40219 8.86431 1.18954C8.65166 0.976889 8.36324 0.857422 8.0625 0.857422C7.76176 0.857422 7.47334 0.976889 7.26069 1.18954C7.04804 1.40219 6.92857 1.69061 6.92857 1.99135ZM13.7321 5.9601V17.8664C13.7321 18.1671 13.8516 18.4555 14.0643 18.6682C14.2769 18.8808 14.5653 19.0003 14.8661 19.0003C15.1668 19.0003 15.4552 18.8808 15.6679 18.6682C15.8805 18.4555 16 18.1671 16 17.8664V5.9601C16 5.65936 15.8805 5.37094 15.6679 5.15829C15.4552 4.94564 15.1668 4.82617 14.8661 4.82617C14.5653 4.82617 14.2769 4.94564 14.0643 5.15829C13.8516 5.37094 13.7321 5.65936 13.7321 5.9601Z" />
					</svg>
				</div>

				<div
					className="HeaderMain-icons__container"
					onClick={() => onClickHandler()}
				>
					<svg
						width="19"
						height="22"
						viewBox="0 0 22 22"
						fill="none"
						xmlns="http://www.w3.org/2000/svg"
						className="HeaderMain-icons__icon"
					>
						<path d="M1.00013 22H21.0001C21.1435 22 21.2851 21.9692 21.4155 21.9097C21.5459 21.8502 21.662 21.7633 21.7559 21.655C21.8498 21.5467 21.9193 21.4195 21.9597 21.282C22.0001 21.1445 22.0105 20.9999 21.9901 20.858L19.9901 6.858C19.956 6.6198 19.837 6.40191 19.6552 6.24431C19.4734 6.08671 19.2408 5.99997 19.0001 6H16.0001V5C16.0001 3.67392 15.4733 2.40215 14.5357 1.46447C13.598 0.526784 12.3262 0 11.0001 0C9.67405 0 8.40228 0.526784 7.4646 1.46447C6.52692 2.40215 6.00013 3.67392 6.00013 5V6H3.00013C2.7595 5.99997 2.52692 6.08671 2.34507 6.24431C2.16322 6.40191 2.0443 6.6198 2.01013 6.858L0.0101334 20.858C-0.0102198 20.9999 0.0001649 21.1445 0.0405837 21.282C0.0810026 21.4195 0.150511 21.5467 0.244398 21.655C0.338286 21.7633 0.454358 21.8502 0.584748 21.9097C0.715139 21.9692 0.856801 22 1.00013 22ZM8.00013 5C8.00013 4.20435 8.3162 3.44129 8.87881 2.87868C9.44142 2.31607 10.2045 2 11.0001 2C11.7958 2 12.5588 2.31607 13.1215 2.87868C13.6841 3.44129 14.0001 4.20435 14.0001 5V6H8.00013V5ZM3.86713 8H6.00013V11C6.00013 11.2652 6.10549 11.5196 6.29303 11.7071C6.48056 11.8946 6.73492 12 7.00013 12C7.26535 12 7.5197 11.8946 7.70724 11.7071C7.89478 11.5196 8.00013 11.2652 8.00013 11V8H14.0001V11C14.0001 11.2652 14.1055 11.5196 14.293 11.7071C14.4806 11.8946 14.7349 12 15.0001 12C15.2654 12 15.5197 11.8946 15.7072 11.7071C15.8948 11.5196 16.0001 11.2652 16.0001 11V8H18.1331L19.8471 20H2.15313L3.86713 8Z" />
					</svg>
					<div className="HeaderMain-icons__count">{cartCount}</div>
				</div>

				<p className="HeaderMain-icons__text">{costDenominator(cost)} ₽</p>
			</div>
		</div>
	);
};

export default HeaderMain;

